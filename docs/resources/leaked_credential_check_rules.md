---
page_title: "cloudflare_leaked_credential_check_rules Resource - Cloudflare"
subcategory: ""
description: |-
  Provides a Cloudflare Leaked Credential Check Rules resource for managing user-defined Leaked Credential detection patterns within a specific zone.
---

# cloudflare_leaked_credential_check_rules (Resource)

Provides a Cloudflare Leaked Credential Check Rules resource for managing user-defined Leaked Credential detection patterns within a specific zone.

## Example Usage

```terraform
# Enable the Leaked Credentials Check detection
resource "cloudflare_leaked_credential_check" "example" {
	zone_id = "399c6f4950c01a5a141b99ff7fbcbd8b"
	enabled = true
}

# Create user-defined detection patterns for Leaked Credentials Check
resource "cloudflare_leaked_credential_check_rules" "example" {
	# The following line ensures that rules are created only for a zone
	# where the Leaked Credentials Check module is enabled, and that the 
	# module is activated before user-defined detection patterns are created.
    zone_id = cloudflare_leaked_credential_check.example.zone_id

	rule {
		username = "lookup_json_string(http.request.body.raw, \"user\")"
		password = "lookup_json_string(http.request.body.raw, \"pass\")"
	}
    
	rule {
		username = "lookup_json_string(http.request.body.raw, \"id\")"
		password = "lookup_json_string(http.request.body.raw, \"secret\")"
	}
}
```
<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `zone_id` (String) The zone identifier to target for the resource.

### Optional

- `rule` (Block Set) List of user-defined patterns for Leaked Credential Check (see [below for nested schema](#nestedblock--rule))

<a id="nestedblock--rule"></a>
### Nested Schema for `rule`

Required:

- `password` (String) The ruleset expression to use in matching the password in a request
- `username` (String) The ruleset expression to use in matching the username in a request.

Read-Only:

- `id` (String) The identifier of this resource.

## Import

Import is supported using the following syntax:

```shell
terraform import cloudflare_leaked_credential_check_rules.example <zone_id>
```
